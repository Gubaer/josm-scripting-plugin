---
  layout: doc
---
<h1>Running JOSM with support for plugins written in Python</h1>

<p>In order to run plugins written in Python, a <a href="http://www.jython.org">Jython</a> jar has to be on the classpath at startup time.</p>

Here's how to start JOSM:
{% highlight bash %}
$  java -classpath "/your/josm.jar:/your/jython.jar" org.openstreetmap.josm.gui.MainApplication
{% endhighlight %}

<code>jython.jar</code> isn't included in the scripting plugin. The scripting plugin can download
it for you, just go to Scripting -> Configure..., or you can download it manually.  

<h2 id="configure">Configuring Python support</h2>

<ul>
  <li>Select Scripting -> Configure ...</li>
  <li>Select the tab "Configure script engines and scripts"</li>
  <li>Select the tab "jython engine"</li>
</ul>

In the preferences you can configure

<ol>
  <li><strong>sys paths</strong>, i.e. directories and jar files where jython is looking for Python packages, modules, and classes
  <li><strong>plugins</strong>, the names of Python plugins which shall be loaded at startup time 
</ol>

<h2>Writing a Python Plugin</h2>

Here's a simple example of a Python plugin for JOSM.

{% highlight python %}
#
# A simple Python plugin which does basically nothing. It only prints
# a message when one of the callback methods is invoked by JOSM.
#
from org.openstreetmap.josm.plugins.scripting.python import JosmPythonPlugin

class HelloWorldPlugin(JosmPythonPlugin):
    def onLoad(self):        
        print "onLoad: starting ..."
        
    def onMapFrameChanged(self, oldFrame, newFrame):
        print "onMapFrameChanged:"
        print "   old frame is: ", oldFrame
        print "   new frame is: ", newFrame 
{% endhighlight %}

The plugin must inherit from
{% highlight java %}
org.openstreetmap.josm.plugins.scripting.python.JosmPythonPlugin
{% endhighlight %}

<h2>Deploying a Python Plugin</h2>
<h3>as source files</h3>
If you have a plugin class <span class="formalName">MyPythonPlugin</span> in the source file <span class="formalName">my_plugin.py</span> then

<ol>
  <li>make sure the parent directory of <span class="formalName">my_plugin.py</span> is on the sys paths (<a href="#configure">how?</a>)
  <li>make sure you add the plugin name <span class="formalName">my_plugin.MyPythonPlugin<span> to the list of plugins (<a href="#configure">how?</a>)
</ol>

<h3>as jar file</h3>

<p>You can create a jar file which includes the python source files required for a plugin.</p>

If you have a plugin class <span class="formalName">MyPythonPlugin</span> in the source file <span class="formalName">my_plugin.py</span>, you can create a jar archive as follows:
{% highlight bash %}
$ jar cvf my_plugin.jar my_plugin.py # add other python modules required by your plugin
{% endhighlight %}

Here's a typical layout of a jar for a Python plugin:

{% highlight bash %}
my_plugin.jar
  +--   my_plugin.py
  +--   other_module.py
  +--   my_package_1
          +-- yet_another_module.py
  +--  ....
{% endhighlight %}

To configure a plugin deployed in a jar file

<ol>
  <li>make sure the jar file <span class="formalName">my_plugin.jar</span> is on the sys paths (<a href="#configure">how?</a>)
  <li>make sure you add the plugin name <span class="formalName">my_plugin.MyPythonPluginy</span> to the list of plugins (<a href="#configure">how?</a>)
</ol>