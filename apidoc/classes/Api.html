---
    layout: apidoc
---

<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3">
     {% include apitoc.html %}
    </div>
    <div class="span9">
      
<div class="apidoc">
<h1 class="title">Class Api</h1>
<p>Collection of static methods to download objects from and upload objects
to the OSM server.</p>

<p><strong>Note:</strong> this class doesn't provide a constructor.
Methods and properties are "static".</p>



{% highlight javascript %}
// load the changeset api
var api = require("josm/api").Api;

// download node 12345
var ds = api.downloadObject(12345, "node");
{% endhighlight %}

 


<table class="member-summary">
<tr>
    <th>Name</th>
    <th>Description</th>
</tr>






<tr>
   <td colspan="2" class="section-header">Methods</td>
</tr>

    <tr>
        <td><a href='#downloadArea'>downloadArea</a></td>
        <td>Downloads the objects within a bounding box</td>
    </tr>

    <tr>
        <td><a href='#downloadObject'>downloadObject</a></td>
        <td>Downloads an object from the server.</td>
    </tr>

    <tr>
        <td><a href='#downloadReferrer'>downloadReferrer</a></td>
        <td>Downloads the objects <em>referring</em> to another object from
    the server.</td>
    </tr>

    <tr>
        <td><a href='#upload'>upload</a></td>
        <td>Uploads objects</td>
    </tr>


</table>










  


<h2>Functions</h2>
    
    <p  id="downloadArea" class="member-header">
        downloadArea:<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/DataSet.html' alt='org.openstreetmap.josm.data.osm.DataSet' target='javadoc'>DataSet</a>
    </p>
    <p><p>Downloads the objects within a bounding box.</p></p>



   <h3>Examples</h3>


{% highlight javascript %}
var api = require("josm/api").Api;
var ds1 = api.downloadArea(new Bounds(
    new LatLon(46.9479186,7.4619484),   // min
    new LatLon(46.9497642, 7.4660683)   // max
));

var ds1 = api.downloadArea({
    min: {lat: 46.9479186, lon: 7.4619484},
    max: {lat: 46.9497642, lon: 7.4660683}
});
{% endhighlight %}



 
    <p  id="downloadObject" class="member-header">
        downloadObject:<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/DataSet.html' alt='org.openstreetmap.josm.data.osm.DataSet' target='javadoc'>DataSet</a>
    </p>
    <p><p>Downloads an object from the server.</p>

<p>There are multiple options to specify what object to download.
In addition, the function accepts a set of optional named parameters
as last argument.</p>

<dl>
  <dt><code class="signature">downloadObject(id, type, ?options)</code></dt>
  <dd><code>id</code> is the global numeric id.
  <code>type</code> is either one of the strings "node", "way",
  or "relation", or one of the  enumeration OsmPrimitiveType.NODE,
  OsmPrimitiveType.WAY, or OsmPrimitiveType.RELATION
  </dd>

  <dt><code class="signature">downloadObject(id, ?options)</code></dt>
  <dd><code>id</code> is a <code>PrimitiveId</code> or an object
  with the (mandatory) properties <code>id</code> and <code>type</code>,
  i.e. an object <code>{id: ..., type: ...}</code>.
  <code>id</code> is again a number, <code>type</code> is again either one
  of the strings "node", "way", or "relation", or one of the
  enumeration OsmPrimitiveType.NODE, OsmPrimitiveType.WAY,
  or OsmPrimitiveType.RELATION.
  </dd>
</dl>
In both cases, <code>?options</code> is an (optional) object with the
following two (optional) properties:
<dl>
  <dt><code class="signature">full</code>: boolean</dt>
  <dd>If <code>true</code>, the object and its immediate children are
  downloaded, i.e. the nodes of a way and
  the relation members of a relation. Default if missing is
  <code>false</code>.</dd>

  <dt><code class="signature">version</code>: number</dt>
  <dd>If present, the specified version of the object is downloaded.
  If missing, the current version is downloaded. If present, the
  option <code>full</code> is ignored.</dd>
</dl></p>



   <h3>Examples</h3>


{% highlight javascript %}
var api = require("josm/api").Api;
var SimlePrimitiveId = org.openstreetmap.josm.data.osm.SimplePrimitiveId;
var OsmPrimitiveType = org.openstreetmap.josm.data.osm.OsmPrimitiveType;

// download the node with id 12345
var ds1 = api.downloadObject(12345, "node");

// download the node with id 12345
var ds2 = api.downloadObject({id: 12345, type: "node"});

// download the full relation (including its members) with id 12345
var id = new SimplePrimitiveId(12345, OsmPrimitiveType.RELATION);
var ds3 = api.downloadObject(id, {full: true});

// download version 5 of the full way 12345 (including its nodes)
var ds4 = api.downloadObject(12345, OsmPrimitiveType.WAY, 
        {version: 5});
{% endhighlight %}



 
    <p  id="downloadReferrer" class="member-header">
        downloadReferrer:<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/DataSet.html' alt='org.openstreetmap.josm.data.osm.DataSet' target='javadoc'>DataSet</a>
    </p>
    <p><p>Downloads the objects <em>referring</em> to another object from
the server.</p>

<p>Downloads primitives from the OSM server which
refer to a specific primitive. Given a node, the referring ways and
relations are downloaded. Given a way or a relation, only referring
relations are downloaded.</p>

<p>The default behaviour is to reply proxy objects only.</p>

<p>If you set the option <code>{full: true}</code>, every referring object
is downloaded in full.</p>

<p>There are multiple options to specify what referrers to download.
In addition, the function accepts a set of optional named parameters as
last argument.</p>

<dl>
  <dt><code class="signature">downloadReferrer(id, type, ?options)
      </code></dt>
  <dd><code>id</code> is the global numeric id.
  <code>type</code> is either one of the strings "node", "way", or
  "relation", or one of the  enumeration
  <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitiveType.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitiveType' target='javadoc'>OsmPrimitiveType</a>.NODE,
  <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitiveType.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitiveType' target='javadoc'>OsmPrimitiveType</a>.WAY,
  or <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitiveType.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitiveType' target='javadoc'>OsmPrimitiveType</a>.RELATION.
  </dd>

  <dt><code class="signature">downloadReferrer(id, ?options)</code></dt>
  <dd><code>id</code> is a <code>PrimitiveId</code> or an object
  with the (mandatory) properties <code>id</code> and <code>type</code>,
  i.e. an object <code>{id: ..., type: ...}</code>.
  <code>id</code> is again a number, <code>type</code> is again either one
  of the strings "node", "way", or "relation", or one of the
  enumeration
  <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitiveType.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitiveType' target='javadoc'>OsmPrimitiveType</a>.NODE,
  <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitiveType.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitiveType' target='javadoc'>OsmPrimitiveType</a>.WAY,
  or <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitiveType.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitiveType' target='javadoc'>OsmPrimitiveType</a>.RELATION.
  </dd>
</dl>
In both cases, <code>?options</code> is an (optional) object with the
following  (optional) property:
<dl>
  <dt><code class="signature">full</code>:boolean</dt>
  <dd>If <code>true</code>, the the <strong>full</strong> objects are
  retrieved using multi-gets. If missing or <code>false</code>,
  only proxy objects are downloaded. Default: false</dd>
</dl></p>



   <h3>Examples</h3>


{% highlight javascript %}
var api = require("josm/api").Api;
var nbuilder = require("josm/builder").NodeBuilder;
var SimlePrimitiveId = org.openstreetmap.josm.data.osm.SimplePrimitiveId;
var OsmPrimitiveType = org.openstreetmap.josm.data.osm.OsmPrimitiveType;

// download the objects referring to the node with id 12345
var ds1 = api.downloadReferrer(12345, "node");

// download the objects referring to the node with id 12345
var ds2 = api.downloadReferrer({id: 12345, type: "node"});

// download the relations referring to the  relation with id 12345.
// Referring relations are downloaded in full.
var id = new SimplePrimitiveId(12345, OsmPrimitiveType.RELATION);
var ds3 = api.downloadReferrer(id, {full: true});

 // create the global node 12345 ...
 var node = nbuilder.create(12345);
 // ... and downloads its referrers in full
 var ds = api.downloadReferrer(node, {full: true});
{% endhighlight %}



 
    <p  id="upload" class="member-header">
        upload:<a href='http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html' alt='java.util.Collection' target='javadoc'>Collection</a>
    </p>
    <p><p>Uploads objects to the server.</p>

<p>You can submit data either as
<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/DataSet.html' alt='org.openstreetmap.josm.data.osm.DataSet' target='javadoc'>DataSet</a>,
<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/APIDataSet.html' alt='org.openstreetmap.josm.data.APIDataSet' target='javadoc'>APIDataSet</a>, javascript array of
<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitive.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitive' target='javadoc'>OsmPrimitive</a>s or
a <a href='http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html' alt='java.util.Collection' target='javadoc'>Collection</a> of
<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/OsmPrimitive.html' alt='org.openstreetmap.josm.data.osm.OsmPrimitive' target='javadoc'>OsmPrimitive</a>s.</p>

<p>This method supports the same upload strategy as the JOSM upload dialog.
Supply the named parameter <code>{strategy: ...}</code> to choose the
strategy.</p>

<p class="documentation-warning">
Be careful when uploading data to the OSM server! Do not upload copyright
protected or test data.
</p>

<p>The method takes care to update the primitives in the uploaded data when
the upload succeeds. For instance, uploaded new primitives become global
objects and get assigned their new id and version, successfully deleted
objects become invisible, etc.</p>

<p>Even if the entire upload of a dataset fails, a subset therefore may
have been uploaded successfully. In order to keep track, which pritives
have been uploaded successfully in case of an error, the method replies a
collection of the successfully uploaded objects.</p>
<p>Named options</p>
<dl>
  <dt><code class="signature">strategy: string|
  <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/io/UploadStrategy.html' alt='org.openstreetmap.josm.io.UploadStrategy' target='javadoc'>UploadStrategy</a></code></dt>
  <dd>Indicates how the data is uploaded. Either one of the strings
    <ul>
         <li>individualobjects</li>
         <li>chunked</li>
         <li>singlerequest</li>
      </ul>
     or one of the enumeration values in
     <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/io/UploadStrategy.html' alt='org.openstreetmap.josm.io.UploadStrategy' target='javadoc'>UploadStrategy</a>.
     Default falue: UploadStrategy.DEFAULT_UPLOAD_STRATEGY
  </dd>

   <dt><code class="signature">changeset:
       number|<a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/Changeset.html' alt='org.openstreetmap.josm.data.osm.Changeset' target='javadoc'>Changeset</a></code></dt>
   <dd>The changeset to which the data is uploaded. Either a number
      (the changeset id) or a
      <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/Changeset.html' alt='org.openstreetmap.josm.data.osm.Changeset' target='javadoc'>Changeset</a> instance.
      Default: creates a new changeset.</dd>

   <dt><code class="signature">chunkSize: number</code></dt>
   <dd>The size of an upload chunk, if the data is uploaded with the
   upload strategy
   <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/io/UploadStrategy.html' alt='org.openstreetmap.josm.io.UploadStrategy' target='javadoc'>UploadStrategy</a>.CHUNKED_DATASET_STRATEGY.</dd>

   <dt><code class="signature">closeChangeset: boolean</code></dt>
   <dd>If true, closes the changeset after the upload. Default: true</dd>
</dl></p>


<h3>Parameters</h3>
<table class="parameters">
<tr>
    <th>Name</th>
    <th>Type</th>
    <th>Description</th>
</tr>

<tr>
    <td>data</td>
    <td><a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/osm/DataSet.html' alt='org.openstreetmap.josm.data.osm.DataSet' target='javadoc'>DataSet</a> | <a href='http://josm.openstreetmap.de/doc/org/openstreetmap/josm/data/APIDataSet.html' alt='org.openstreetmap.josm.data.APIDataSet' target='javadoc'>APIDataSet</a> | array | <a href='http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html' alt='java.util.Collection' target='javadoc'>Collection</a></td>
    <td>the data to upload</td>
</tr>

<tr>
    <td>comment</td>
    <td>string</td>
    <td>the upload comment</td>
</tr>

<tr>
    <td>options</td>
    <td>object</td>
    <td>(optional) various options (see above)</td>
</tr>

</table>


   <h3>Examples</h3>


{% highlight javascript %}
var ds = new org.openstreetmap.josm.data.osm.DataSet();
ds.wayBuilder.withNodes(
    ds.nodeBuilder.withTags({name: 'node1'}).create(),
    ds.nodeBuilder.withTags({name: 'node2'}.create()
).withTags({name: 'way1'}).create();
var api = require("josm/api").Api;

// uploads the data in a new changeset in one chunk)
var processed = api.upload(ds, "just testing");
{% endhighlight %}



 

 
</div>

    </div>
  </div>
</div>
